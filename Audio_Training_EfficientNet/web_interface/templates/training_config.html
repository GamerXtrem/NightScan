<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuration EfficientNet - NightScan</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #2563eb;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --dark-color: #1f2937;
            --light-bg: #f8fafc;
        }

        body {
            background-color: var(--light-bg);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, #3b82f6 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }

        .config-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: none;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .config-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .config-header {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            border-radius: 12px 12px 0 0;
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .preset-card {
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .preset-card:hover {
            border-color: var(--primary-color);
            background-color: #f8fafc;
        }

        .preset-card.selected {
            border-color: var(--primary-color);
            background-color: #eff6ff;
        }

        .preset-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        .badge-fast { background-color: #dcfce7; color: #166534; }
        .badge-balanced { background-color: #dbeafe; color: #1e40af; }
        .badge-quality { background-color: #fef3c7; color: #d97706; }

        .form-section {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .section-title {
            color: var(--dark-color);
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid #f3f4f6;
        }

        .param-description {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }

        .advanced-toggle {
            cursor: pointer;
            user-select: none;
        }

        .advanced-section {
            display: none;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid #e5e7eb;
        }

        .btn-custom {
            border-radius: 8px;
            padding: 0.75rem 2rem;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .validation-feedback {
            display: block;
            margin-top: 0.25rem;
        }

        .tooltip-info {
            color: var(--primary-color);
            cursor: help;
        }

        .config-preview {
            background: #f8fafc;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1><i class="fas fa-cog me-3"></i>Configuration d'Entraînement</h1>
                    <p class="mb-0">Personnalisez les paramètres d'entraînement EfficientNet</p>
                </div>
                <div class="col-md-4 text-end">
                    <a href="/" class="btn btn-light btn-custom">
                        <i class="fas fa-arrow-left me-2"></i>Retour au Dashboard
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <form id="configForm">
            <!-- Preset Selection -->
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-magic me-2 text-primary"></i>
                    Configurations Prédéfinies
                </h4>
                
                <div class="row">
                    <div class="col-md-4">
                        <div class="preset-card" data-preset="efficientnet_b0_fast">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <h6 class="mb-0">EfficientNet-B0</h6>
                                <span class="preset-badge badge-fast">Rapide</span>
                            </div>
                            <p class="text-muted small mb-2">Configuration optimisée pour la vitesse d'entraînement</p>
                            <div class="small">
                                <div><strong>Batch Size:</strong> 64</div>
                                <div><strong>Epochs:</strong> 30</div>
                                <div><strong>Paramètres:</strong> ~5.3M</div>
                                <div><strong>Temps estimé:</strong> 2-4h</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-4">
                        <div class="preset-card selected" data-preset="efficientnet_b1_balanced">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <h6 class="mb-0">EfficientNet-B1</h6>
                                <span class="preset-badge badge-balanced">Équilibré</span>
                            </div>
                            <p class="text-muted small mb-2">Meilleur compromis performance/vitesse</p>
                            <div class="small">
                                <div><strong>Batch Size:</strong> 32</div>
                                <div><strong>Epochs:</strong> 50</div>
                                <div><strong>Paramètres:</strong> ~7.8M</div>
                                <div><strong>Temps estimé:</strong> 4-8h</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-4">
                        <div class="preset-card" data-preset="efficientnet_b2_quality">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <h6 class="mb-0">EfficientNet-B2</h6>
                                <span class="preset-badge badge-quality">Qualité</span>
                            </div>
                            <p class="text-muted small mb-2">Configuration pour la meilleure précision</p>
                            <div class="small">
                                <div><strong>Batch Size:</strong> 16</div>
                                <div><strong>Epochs:</strong> 100</div>
                                <div><strong>Paramètres:</strong> ~9.2M</div>
                                <div><strong>Temps estimé:</strong> 8-16h</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Configuration -->
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-database me-2 text-primary"></i>
                    Configuration des Données
                </h4>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">
                                Données d'Entraînement (CSV)
                                <i class="fas fa-info-circle tooltip-info ms-1" title="Fichier CSV contenant les chemins et labels des spectrogrammes d'entraînement"></i>
                            </label>
                            <input type="text" class="form-control" id="trainCsv" value="data/processed/csv/train.csv" required>
                            <div class="param-description">
                                Chemin vers le fichier CSV des données d'entraînement
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">
                                Données de Validation (CSV)
                                <i class="fas fa-info-circle tooltip-info ms-1" title="Fichier CSV contenant les chemins et labels des spectrogrammes de validation"></i>
                            </label>
                            <input type="text" class="form-control" id="valCsv" value="data/processed/csv/val.csv" required>
                            <div class="param-description">
                                Chemin vers le fichier CSV des données de validation
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">
                                Répertoire de Sortie
                                <i class="fas fa-info-circle tooltip-info ms-1" title="Répertoire où sauvegarder le modèle entraîné et les métriques"></i>
                            </label>
                            <input type="text" class="form-control" id="outputDir" value="models/efficientnet_trained" required>
                            <div class="param-description">
                                Répertoire pour sauvegarder le modèle et les résultats
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Validation Croisée</label>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="crossValidation">
                                <label class="form-check-label" for="crossValidation">
                                    Activer la validation croisée k-fold (5 folds)
                                </label>
                            </div>
                            <div class="param-description">
                                Évaluation plus robuste mais entraînement plus long
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Training Parameters -->
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-sliders-h me-2 text-primary"></i>
                    Paramètres d'Entraînement
                </h4>
                
                <div class="row">
                    <div class="col-md-3">
                        <div class="mb-3">
                            <label class="form-label">
                                Nombre d'Époques
                                <i class="fas fa-info-circle tooltip-info ms-1" title="Nombre de passages complets sur l'ensemble d'entraînement"></i>
                            </label>
                            <input type="number" class="form-control" id="epochs" value="50" min="1" max="500" required>
                            <div class="param-description">
                                Plus d'époques = entraînement plus long
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-3">
                        <div class="mb-3">
                            <label class="form-label">
                                Taille de Batch
                                <i class="fas fa-info-circle tooltip-info ms-1" title="Nombre d'échantillons traités simultanément"></i>
                            </label>
                            <select class="form-select" id="batchSize">
                                <option value="8">8 (GPU faible)</option>
                                <option value="16">16 (GPU moyen)</option>
                                <option value="32" selected>32 (Recommandé)</option>
                                <option value="64">64 (GPU puissant)</option>
                                <option value="128">128 (GPU très puissant)</option>
                            </select>
                            <div class="param-description">
                                Plus grand = plus rapide mais plus de mémoire
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-3">
                        <div class="mb-3">
                            <label class="form-label">
                                Taux d'Apprentissage
                                <i class="fas fa-info-circle tooltip-info ms-1" title="Vitesse d'adaptation des poids du modèle"></i>
                            </label>
                            <input type="number" class="form-control" id="learningRate" value="0.0001" step="0.00001" min="0.00001" max="0.01" required>
                            <div class="param-description">
                                Plus petit = convergence plus stable
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-3">
                        <div class="mb-3">
                            <label class="form-label">Dispositif</label>
                            <select class="form-select" id="device">
                                <option value="auto" selected>Automatique</option>
                                <option value="cuda">CUDA (NVIDIA GPU)</option>
                                <option value="mps">MPS (Apple Silicon)</option>
                                <option value="cpu">CPU seulement</option>
                            </select>
                            <div class="param-description">
                                GPU fortement recommandé
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Advanced Parameters -->
            <div class="form-section">
                <h4 class="section-title advanced-toggle" onclick="toggleAdvanced()">
                    <i class="fas fa-cogs me-2 text-primary"></i>
                    Paramètres Avancés
                    <i class="fas fa-chevron-down ms-2" id="advancedIcon"></i>
                </h4>
                
                <div class="advanced-section" id="advancedSection">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label">Précision Mixte</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="mixedPrecision" checked>
                                    <label class="form-check-label" for="mixedPrecision">
                                        Activer FP16 (recommandé)
                                    </label>
                                </div>
                                <div class="param-description">
                                    Réduit l'usage mémoire et accélère l'entraînement
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label">
                                    Gradient Clipping
                                    <i class="fas fa-info-circle tooltip-info ms-1" title="Évite les gradients explosifs"></i>
                                </label>
                                <input type="number" class="form-control" id="gradientClipping" value="1.0" step="0.1" min="0.1" max="5.0">
                                <div class="param-description">
                                    Valeur max des gradients (1.0 = recommandé)
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label">
                                    Early Stopping Patience
                                    <i class="fas fa-info-circle tooltip-info ms-1" title="Nombre d'époques sans amélioration avant arrêt"></i>
                                </label>
                                <input type="number" class="form-control" id="earlyStoppingPatience" value="10" min="3" max="50">
                                <div class="param-description">
                                    Arrêt automatique si pas d'amélioration
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label">Augmentation de Données</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="useAugmentation" checked>
                                    <label class="form-check-label" for="useAugmentation">
                                        Activer SpecAugment et Mixup
                                    </label>
                                </div>
                                <div class="param-description">
                                    Améliore la généralisation du modèle
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label">
                                    Masquage Fréquentiel
                                    <i class="fas fa-info-circle tooltip-info ms-1" title="Paramètre de SpecAugment pour masquer des bandes de fréquence"></i>
                                </label>
                                <input type="number" class="form-control" id="freqMask" value="30" min="10" max="80">
                                <div class="param-description">
                                    Taille max des masques fréquentiels
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label">
                                    Masquage Temporel
                                    <i class="fas fa-info-circle tooltip-info ms-1" title="Paramètre de SpecAugment pour masquer des segments temporels"></i>
                                </label>
                                <input type="number" class="form-control" id="timeMask" value="40" min="10" max="100">
                                <div class="param-description">
                                    Taille max des masques temporels
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">
                                    Alpha Mixup
                                    <i class="fas fa-info-circle tooltip-info ms-1" title="Paramètre de mélange pour l'augmentation Mixup"></i>
                                </label>
                                <input type="number" class="form-control" id="mixupAlpha" value="0.2" step="0.1" min="0.1" max="1.0">
                                <div class="param-description">
                                    Intensité du mélange Mixup (0.2 = recommandé)
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Nombre de Workers</label>
                                <input type="number" class="form-control" id="numWorkers" value="4" min="0" max="16">
                                <div class="param-description">
                                    Processus parallèles pour le chargement de données
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Configuration Preview -->
            <div class="form-section">
                <h4 class="section-title">
                    <i class="fas fa-eye me-2 text-primary"></i>
                    Aperçu de la Configuration
                </h4>
                
                <div class="config-preview" id="configPreview">
                    <div class="text-center text-muted">
                        La configuration sera affichée ici...
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="form-section text-center">
                <div class="d-flex gap-3 justify-content-center flex-wrap">
                    <button type="button" class="btn btn-outline-secondary btn-custom" onclick="resetToDefaults()">
                        <i class="fas fa-undo me-2"></i>Réinitialiser
                    </button>
                    
                    <button type="button" class="btn btn-outline-primary btn-custom" onclick="saveConfiguration()">
                        <i class="fas fa-save me-2"></i>Sauvegarder Config
                    </button>
                    
                    <button type="button" class="btn btn-primary btn-custom" onclick="validateAndStart()">
                        <i class="fas fa-play me-2"></i>Démarrer l'Entraînement
                    </button>
                </div>
            </div>
        </form>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Configuration state
        let currentConfig = {
            preset: 'efficientnet_b1_balanced',
            trainCsv: 'data/processed/csv/train.csv',
            valCsv: 'data/processed/csv/val.csv',
            outputDir: 'models/efficientnet_trained',
            epochs: 50,
            batchSize: 32,
            learningRate: 0.0001,
            device: 'auto',
            mixedPrecision: true,
            gradientClipping: 1.0,
            earlyStoppingPatience: 10,
            useAugmentation: true,
            freqMask: 30,
            timeMask: 40,
            mixupAlpha: 0.2,
            numWorkers: 4,
            crossValidation: false
        };

        // Preset configurations
        const presets = {
            'efficientnet_b0_fast': {
                epochs: 30,
                batchSize: 64,
                learningRate: 0.0002
            },
            'efficientnet_b1_balanced': {
                epochs: 50,
                batchSize: 32,
                learningRate: 0.0001
            },
            'efficientnet_b2_quality': {
                epochs: 100,
                batchSize: 16,
                learningRate: 0.00005
            }
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            updateConfigPreview();
            
            // Initialize tooltips
            var tooltipTriggerList = [].slice.call(document.querySelectorAll('[title]'));
            var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
        });

        function setupEventListeners() {
            // Preset selection
            document.querySelectorAll('.preset-card').forEach(card => {
                card.addEventListener('click', function() {
                    selectPreset(this.dataset.preset);
                });
            });

            // Form inputs
            document.getElementById('configForm').addEventListener('input', updateConfigFromForm);
        }

        function selectPreset(presetName) {
            // Update UI
            document.querySelectorAll('.preset-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelector(`[data-preset="${presetName}"]`).classList.add('selected');

            // Update config
            currentConfig.preset = presetName;
            const preset = presets[presetName];
            
            if (preset) {
                currentConfig.epochs = preset.epochs;
                currentConfig.batchSize = preset.batchSize;
                currentConfig.learningRate = preset.learningRate;
                
                // Update form
                document.getElementById('epochs').value = preset.epochs;
                document.getElementById('batchSize').value = preset.batchSize;
                document.getElementById('learningRate').value = preset.learningRate;
            }

            updateConfigPreview();
        }

        function updateConfigFromForm() {
            currentConfig.trainCsv = document.getElementById('trainCsv').value;
            currentConfig.valCsv = document.getElementById('valCsv').value;
            currentConfig.outputDir = document.getElementById('outputDir').value;
            currentConfig.epochs = parseInt(document.getElementById('epochs').value);
            currentConfig.batchSize = parseInt(document.getElementById('batchSize').value);
            currentConfig.learningRate = parseFloat(document.getElementById('learningRate').value);
            currentConfig.device = document.getElementById('device').value;
            currentConfig.mixedPrecision = document.getElementById('mixedPrecision').checked;
            currentConfig.gradientClipping = parseFloat(document.getElementById('gradientClipping').value);
            currentConfig.earlyStoppingPatience = parseInt(document.getElementById('earlyStoppingPatience').value);
            currentConfig.useAugmentation = document.getElementById('useAugmentation').checked;
            currentConfig.freqMask = parseInt(document.getElementById('freqMask').value);
            currentConfig.timeMask = parseInt(document.getElementById('timeMask').value);
            currentConfig.mixupAlpha = parseFloat(document.getElementById('mixupAlpha').value);
            currentConfig.numWorkers = parseInt(document.getElementById('numWorkers').value);
            currentConfig.crossValidation = document.getElementById('crossValidation').checked;

            updateConfigPreview();
        }

        function updateConfigPreview() {
            const preview = document.getElementById('configPreview');
            
            const html = `
<strong>Configuration EfficientNet</strong>
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

<strong>Modèle:</strong> ${currentConfig.preset}
<strong>Données:</strong>
  • Entraînement: ${currentConfig.trainCsv}
  • Validation: ${currentConfig.valCsv}
  • Sortie: ${currentConfig.outputDir}

<strong>Entraînement:</strong>
  • Époques: ${currentConfig.epochs}
  • Batch Size: ${currentConfig.batchSize}
  • Learning Rate: ${currentConfig.learningRate}
  • Dispositif: ${currentConfig.device}
  • Validation croisée: ${currentConfig.crossValidation ? 'Activée' : 'Désactivée'}

<strong>Optimisations:</strong>
  • Précision mixte: ${currentConfig.mixedPrecision ? 'Activée' : 'Désactivée'}
  • Gradient clipping: ${currentConfig.gradientClipping}
  • Early stopping: ${currentConfig.earlyStoppingPatience} époques

<strong>Augmentation:</strong>
  • Augmentation: ${currentConfig.useAugmentation ? 'Activée' : 'Désactivée'}
  • Masque fréquentiel: ${currentConfig.freqMask}
  • Masque temporel: ${currentConfig.timeMask}
  • Alpha mixup: ${currentConfig.mixupAlpha}

<strong>Performance:</strong>
  • Workers: ${currentConfig.numWorkers}
            `;
            
            preview.innerHTML = html;
        }

        function toggleAdvanced() {
            const section = document.getElementById('advancedSection');
            const icon = document.getElementById('advancedIcon');
            
            if (section.style.display === 'none' || section.style.display === '') {
                section.style.display = 'block';
                icon.classList.remove('fa-chevron-down');
                icon.classList.add('fa-chevron-up');
            } else {
                section.style.display = 'none';
                icon.classList.remove('fa-chevron-up');
                icon.classList.add('fa-chevron-down');
            }
        }

        function resetToDefaults() {
            if (confirm('Êtes-vous sûr de vouloir réinitialiser tous les paramètres ?')) {
                selectPreset('efficientnet_b1_balanced');
                
                // Reset form values
                document.getElementById('trainCsv').value = 'data/processed/csv/train.csv';
                document.getElementById('valCsv').value = 'data/processed/csv/val.csv';
                document.getElementById('outputDir').value = 'models/efficientnet_trained';
                document.getElementById('device').value = 'auto';
                document.getElementById('mixedPrecision').checked = true;
                document.getElementById('gradientClipping').value = 1.0;
                document.getElementById('earlyStoppingPatience').value = 10;
                document.getElementById('useAugmentation').checked = true;
                document.getElementById('freqMask').value = 30;
                document.getElementById('timeMask').value = 40;
                document.getElementById('mixupAlpha').value = 0.2;
                document.getElementById('numWorkers').value = 4;
                document.getElementById('crossValidation').checked = false;
                
                updateConfigFromForm();
            }
        }

        function saveConfiguration() {
            const configJson = JSON.stringify(currentConfig, null, 2);
            const blob = new Blob([configJson], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `efficientnet_config_${new Date().toISOString().slice(0, 10)}.json`;
            a.click();
            
            URL.revokeObjectURL(url);
            
            alert('Configuration sauvegardée !');
        }

        async function validateAndStart() {
            // Validation
            if (!currentConfig.trainCsv || !currentConfig.valCsv) {
                alert('Veuillez spécifier les chemins vers les fichiers de données');
                return;
            }

            if (currentConfig.epochs < 1 || currentConfig.epochs > 500) {
                alert('Le nombre d\'époques doit être entre 1 et 500');
                return;
            }

            if (currentConfig.learningRate < 0.00001 || currentConfig.learningRate > 0.01) {
                alert('Le taux d\'apprentissage doit être entre 0.00001 et 0.01');
                return;
            }

            // Confirmation
            const estimatedTime = Math.ceil(currentConfig.epochs * currentConfig.batchSize / 100);
            if (!confirm(`Démarrer l'entraînement avec cette configuration ?\n\nTemps estimé: ${estimatedTime}h\nÉpoques: ${currentConfig.epochs}\nModèle: ${currentConfig.preset}`)) {
                return;
            }

            // Redirection vers le dashboard avec configuration
            sessionStorage.setItem('trainingConfig', JSON.stringify(currentConfig));
            window.location.href = '/';
        }
    </script>
</body>
</html>